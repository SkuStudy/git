## 커밋

### 4.1 코드의 변화

커밋이란? 깃이 코드 변화를 기록하는 행위.

커밋 단위로 저장소에 변경사항을 저장할 수 있으며, 롤백도 가능.

#### 4.1.1 파일 관리 방법

일반적인 파일 이력 관리의 방법은 복사로서, 무수히 파일이 생성되는 단점이 존재.
또한, 그로인해 Disk 를 많이 차지하게 됨.

반면, 커밋은 변경사항에 대해서만 저장하고 방식으로 동일한 File Name으로 이력 관리가 가능하며
용량을 효율적으로 사용하게 됨.

### 4.2 새 파일 생성 및 감지

#### 4.2.1 새 파일 생성

아래오 같은 study04_test1.txt 파일을 생성한다.

```bash
mkdir gitstudy04
cd gitstudy04
git init

echo "test1" >> study04_test1.txt
```

위와 같이, 워킹 디렉터리에 파일이 추가되면 깃은 변화된 상태를 자동으로 감지한다.

아래와 같이 status 명령어를 통해 감지한것을 확인 할 수 있으며 추적하는 파일로 등록하지 않았기에 Untracked files로 감지하는것을 볼 수 있다.

![image](https://user-images.githubusercontent.com/31622350/141898373-49b698d7-4079-462a-a8b9-0f60c5878271.png)


### 4.3 깃에 새 파일 등록

커밋을 하려면 파일의 상태는 tracked여야 한다.

워킹 디렉터리에 새로 추가된 파일을 tracked 상태로 만들기 위해서는 등록이라는 행위를 수행해야 한다.

#### 4.3.1 스테이지에 등록

등록이란, 워킹 디렉터리에 있는 파일을 스테이지 영역으로 복사하는것을 의미.

**명령어로 등록: add 명령어**

add 명령어를 통해 스테이지 영역으로 옮길수 있다.

```bash
git add study04_test1.txt
```

![image](https://user-images.githubusercontent.com/31622350/141902099-6007e284-f2fb-42f0-b850-c75b5e207648.png)

정보 이력을 추적하고 싶은 파일만 스테이지 영역에 추가하면 된다.
단, 빈 폴더의 경우에는 스테이지 영역에 등록할 수 없음.

#### 4.3.2 파일 등록 취소

스테이지에 등록한 파일을 다시 워킹 디렉터리 영역으로 옮길때는 rm 혹은 reset 명령어를 사용합니다.

```bash
git rm --cached study04_test1.txt
```

단, 한번이라도 커밋을 했다면 rm cached가 아닌 reset 명령어를 사용해야 함.


만약, 커밋한 파일을 스테이지에서 삭제한다면 아래와 같이 untracked로 상태는 변경되며 스테이지 영역에 없으므로 삭제로 간주하게 된다.

```bash
git add study04_test1.txt
git commit -m 'study04_test1 commit'
git rm --cached study04_test1.txt
```

![image](https://user-images.githubusercontent.com/31622350/141911043-ffbe9b0a-692e-48b1-9469-a7fac26236fa.png)


#### 4.3.4 등록된 파일 이름이 변경되었을 때

파일 이름이 변경되는 경우에는 mv 명령얼르 사용하면 된다.

```bash
git mv <file_name> <new_file_name>
```

### 4.4 첫 번째 커밋

#### 4.4.1 HEAD

HEAD는 커밋을 가리키는 묵시적 참조 포인터.

HEAD는 latest 커밋을 가리키고 있으며, 최초에는 없고 최소 한번 커밋을 해야 존재합니다.

#### 4.4.2 스냅샷

깃은 스냅샷 방식으로 파일 버전을 관리.

스냅샷은 HEAD가 가리키는 커밋을 기반으로 수행되어지며, 스테이지 영역과 비교하여 새로운 커밋을 기록.

#### 4.4.3 파일 상태와 커밋

커밋은 워킹 디렉터리가 깨끗하게 정리되어 있지 않으면 수행할 수 없음.
또한, 스테이지 영역의 파일이 변경되지 않은 경우 커밋을 2번 실행 할 수도 없음.

**커밋 메시지**

커밋 할 때에는 메시지가 꼭 동반되어야 함.

```bash
git commit
```

위 명령어 수행시 vi 에디터가 열리며 메시지를 작성하면 됨.

**파일 등록과 커밋을 동시에 하는 방법**

```bash
git commit -a
```

### 4.5 커밋 확인

#### 4.5.1 스테이지 초기화

커밋을 한 뒤에는 스테이지 영역은 초기화됨.

#### 4.5.2 로그 기록 확인

커밋 기록들은 log 명령어를 통해 확인 할 수 있음.

```bash
git log
```

### 4.6 두 번째 커밋

#### 4.6.2 파일 변경 사항 확인

![image](https://user-images.githubusercontent.com/31622350/141924781-e67a00a9-f2b6-426b-9225-443d48c6acf2.png)

#### 4.6.3 수정된 파일 되돌리기

```bash
git checkout -- <수정파일이름>
```

#### 4.6.4 스테이지에 등록

변경된 소스는 아래와 같은 flow로 동작.

![image](https://user-images.githubusercontent.com/31622350/141925035-0ac1bbc6-36b3-418a-ba18-b54f926ca96d.png)


#### 4.6.5 두번째 커밋 - 커밋 메시지

커밋 시 간편하게 메시지를 넣는 방법으로는 -m 옵션이 있음.

```bash
git commit -m "commit message"
```

-am 옵션으로 add와 message를 한번에 할수도 있음.

```bash
git commit -am "commit message"
```

### 4.7 메시지가 없는 빈 커밋

메시지가 없는 커밋의 경우에는 --allow-empty-message를 통해 가능.

```bash
git commit --allow-empty-message -m ""
```

### 4.8 커밋 아이디

커밋 아이디는 `git log` 명령어 시 나오는 영문, 숫자 조합의 일련 값입니다.
해당 값은 커밋을 나타내는 unique한 값입니다.
> commit Id 는 sha1 해시 알고리즘을 통해 생성되는 값입니다.

### 4.9 커밋 로그

첫번째 줄의 커밋 메시지만 보고 싶은 경우에는 `--pretty=short` 옵션을 사용할 수 있다.

#### 4.9.2 특정 파일의 로그

전체가 아닌 특정 파일에 대한 로그 이력도 확인이 가능합니다.

```bash
git log <file>
```

### 4.10 diff 명령어

깃은 커밋을 기준으로 파일들의 수정이력을 비교해 볼 수 있도록 `diff` 기능을 제공함.

#### 4.10.2 워킹 디렉터리 vs 스테이지 영역

add 명령 전 워킹 디렉터리와 스테이지 영역간 변경 사항을 비교할 수 있습니다.

```bash
git diff
```

#### 4.10.3 커밋 간 차이

스테이지 영역의 수정 파일을 커밋하지 않았다면, 최신 커밋과 변경 내용을 비굑하여 볼수도 있습니다.

```bash
git diff head
